!function(e){function t(t){for(var n,c,a=t[0],s=t[1],i=t[2],f=0,d=[];f<a.length;f++)c=a[f],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&d.push(o[c][0]),o[c]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(l&&l(t);d.length;)d.shift()();return u.push.apply(u,i||[]),r()}function r(){for(var e,t=0;t<u.length;t++){for(var r=u[t],n=!0,a=1;a<r.length;a++){var s=r[a];0!==o[s]&&(n=!1)}n&&(u.splice(t--,1),e=c(c.s=r[0]))}return e}var n={},o={0:0},u=[];function c(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.m=e,c.c=n,c.d=function(e,t,r){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},c.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(r,n,function(t){return e[t]}.bind(null,n));return r},c.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var a=window.webpackJsonp=window.webpackJsonp||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var i=0;i<a.length;i++)t(a[i]);var l=s;u.push([121,1]),r()}({121:function(e,t,r){r(122),e.exports=r(309)},308:function(e,t,r){},309:function(e,t,r){"use strict";r.r(t);r(308);var n=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){t.reduce((function(e,t){return t(e)}),e)}};function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=function(e){var t=e.rack,r=e.changePlace,n=function(e){return{elem:e,before:e.previousElementSibling,isShelf:e===e.closest("#shelf"),id:+e.dataset.id,order:+e.dataset.order,shelf:{elem:e.closest("#shelf"),id:+e.closest("#shelf").dataset.id,order:+e.closest("#shelf").dataset.order}}},o=function(e){e.before.after(e.elem),e.elem.style=""};t.elem.onmousedown=function(e){e.target.ondragstart=function(){return!1};var t=e.target.closest(".product-image");if(t){var c,a,s={drop:n(t)},i=e.clientX-t.getBoundingClientRect().left,l=e.clientY-t.getBoundingClientRect().top;c=t,a=getComputedStyle(c).width,c.style.position="absolute",c.style.zIndex=10,c.style.width=.8*parseInt(a)+"px",c.style.height="auto",document.body.append(c),m(e.pageX,e.pageY),t.classList.add("grab");var f=null,d=null,p=function e(r){m(r.pageX,r.pageY),t.style.display="none";var u=document.elementFromPoint(r.clientX,r.clientY);t.style.display="block",u||(o(s.drop),document.removeEventListener("mousemove",e),t.onmouseup=null,t.classList.remove("grab")),d=u&&u.dataset.droppable?u:null,f!==d&&(f&&function(e){e.elem.classList.remove("drop")}(n(f)),(f=d)&&function(e){e.elem.classList.add("drop")}(n(f)))};document.addEventListener("mousemove",p),t.onmouseup=function(){d?(s=u(u({},s),{},{below:n(d)}),r(s)):o(s.drop),document.removeEventListener("mousemove",p),t.onmouseup=null}}function m(e,r){t.style.left=e-.8*i+"px",t.style.top=r-.8*l+"px"}}};function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t,r,n,o,u,c){try{var a=e[u](c),s=a.value}catch(e){return void r(e)}a.done?t(s):Promise.resolve(s).then(n,o)}function f(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var u=e.apply(t,r);function c(e){l(u,n,o,c,a,"next",e)}function a(e){l(u,n,o,c,a,"throw",e)}c(void 0)}))}}var d,p=function(){var e=f(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.jsonbin.io/b/5e6b40e207f1954acedf3427/1",{headers:{"Secret-key":"$2b$10$zeNmy2u803VjpcCj2JEa8uzC4t9YjXuLm3izVwWlCLigtPBES89dG"}});case 2:return t=e.sent,e.next=5,t.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m={elem:document.getElementById("rack"),shelvs:{elem:document.getElementById("shelvs"),amount:5,data:null}},h={elem:document.getElementById("state")},v=(d=function(e){for(var t=[],r=0;r<e;r++)t.push({shelfOrder:r,shelfId:Math.round(100*Math.random()),products:[]});return t},function(e){return d(m.shelvs.amount).map((function(t){var r=e.find((function(e){return e.shelfOrder===t.shelfOrder}));return r||t}))}),b=function(e){var t=e.shelfId,r=e.shelfOrder,n=e.products,o=document.createElement("div");o.className="shelf",o.setAttribute("data-id",t),o.setAttribute("data-order",r),o.setAttribute("data-droppable",!0),o.setAttribute("data-role","shelf"),o.id="shelf";var u=document.createElement("span");return u.className="shelf-order",u.textContent=r,o.append(u),n.forEach((function(e){return o.append(function(e){var t=e.productId,r=e.productOrder,n=e.productUrl,o=document.createElement("img");return o.className="product-image",o.src=n,o.alt="product-".concat(t),o.setAttribute("data-id",t),o.setAttribute("data-order",r),o.setAttribute("data-droppable",!0),o.setAttribute("data-role","product"),o}(e))})),o},y=n((function(e){return e.forEach((function(e){e.products.sort((function(e,t){return e.productOrder-t.productOrder}))})),e.sort((function(e,t){return t.shelfOrder-e.shelfOrder})),e}),(function(e){return localStorage.setItem("state",JSON.stringify(e)),e}),(function(e){return h.elem.textContent=JSON.stringify(e,null,2),e}),(function(e){return e.map(b)}),(function(e){for(;m.shelvs.elem.firstChild;)m.shelvs.elem.firstChild.remove();e.forEach((function(e){var t;m.shelvs.elem.append(e),m.shelvs.elem.append(((t=document.createElement("hr")).className="separator",t))}))}));(function(){var e=f(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=JSON.parse(localStorage.getItem("state")),e.t0){e.next=5;break}return e.next=4,p();case 4:e.t0=e.sent;case 5:t=e.t0,m.shelvs.data=v(t),y(m.shelvs.data);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()(),a({rack:m,changePlace:function(e){var t=e.drop,r=e.below,n=m.shelvs.data,o=function(e){e.forEach((function(e,t){e.productOrder=t+1}))};!function(e){var t=n.find((function(e){return e.shelfOrder===r.shelf.order})).products;if(r.isShelf)return e.productOrder=t.length+1,void t.push(e);var u=t.findIndex((function(e){return e.productOrder===r.order}));e.productOrder=u+1,t.splice(u,0,e),o(t)}(function(){t.elem.remove();var e=n.find((function(e){return e.shelfOrder===t.shelf.order})).products,u=e.findIndex((function(e){return e.productOrder===t.order})),c=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e[u]);return e.splice(u,1),t.shelf.order!==r.shelf.order&&o(e),c}()),y(m.shelvs.data)}})}});
//# sourceMappingURL=main.3fb5a132344fe1c5c757.js.map